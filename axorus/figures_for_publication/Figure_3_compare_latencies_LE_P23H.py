import pandas as pd
from scipy.stats import mannwhitneyu


# Generated by code in the axorus-analysis repo
# Figure_2F_firing_rate_and_latencies
loadname = r'C:\axorus\figures\paper\Figure_2\latency_stats_etc.csv'
df_p23h = pd.read_csv(loadname, index_col=0, header=0)

# Generated by Figure_3_lap4acet in this repo
loadname = r'C:\axorus\figures\paper\Figure_3\latency_data.csv'
df_le = pd.read_csv(loadname, index_col=0, header=0)


latencies_p23h = df_p23h.latency.values
latencies_le_lap4 = df_le['lap4 response_latency'].dropna().values

stat, p = mannwhitneyu(latencies_p23h, latencies_le_lap4, alternative='two-sided')

print(f'Latencies P23H vs latencies LE under lap4')
print(f'stat: {stat:.2f}, p: {p:.4f} (Mann Whitney U)')
